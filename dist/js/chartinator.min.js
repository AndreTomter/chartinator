/*! Chartinator jQuery plugin 2015-04-10 version: 0.3.7 */
!function(a,b,c,d){"use strict";var e=function(c,e){var f=this,g=a(c),h=a(c);return f.fontFamily=a("body").css("font-family").replace(/["']{1}/gi,"")||"Arial, Helvetica, sans-serif",f.optionsInit={urlJSAPI:"https://www.google.com/jsapi",googleSheetKey:!1,columns:!1,colIndexes:!1,rows:!1,tableSel:!1,ignoreRow:[],ignoreCol:[],transpose:!1,tooltipConcat:!1,annotationConcat:!1,chartType:"BarChart",chartId:"c24_"+d.random().toString(36).substr(2,9),chartClass:"chtr-chart",chartAspectRatio:!1,chartZoom:0,chartOffset:!1,barChart:{fontSize:!1,chartArea:{left:"20%",top:40,width:"75%",height:"85%"},fontName:f.fontFamily,legend:{position:"bottom"}},pieChart:{fontSize:!1,chartArea:{left:0,top:0,width:"100%",height:"100%"},fontName:f.fontFamily},columnChart:{fontSize:!1,fontName:f.fontFamily,legend:{position:"bottom"}},lineChart:{fontSize:!1,fontName:f.fontFamily,legend:{position:"bottom"}},areaChart:{fontSize:!1,fontName:f.fontFamily,legend:{position:"bottom"}},calendar:{cellScaleFactor:.017,calendar:{monthLabel:{fontSize:!1,fontName:f.fontFamily},dayOfWeekLabel:{fontSize:!1,fontName:f.fontFamily}}},table:{formatter:{type:"none",column:1},allowHtml:!0,cssClassNames:{headerRow:"headerRow",tableRow:"tableRow",oddTableRow:"oddTableRow",selectedTableRow:"selectedTableRow",hoverTableRow:"hoverTableRow",headerCell:"headerCell",tableCell:"tableCell",rowNumberCell:"rowNumberCell"}},showTable:"hide",showTableCSS:{position:"static",top:0,width:""},hideTableCSS:{position:"absolute",top:"-9999px",width:g.width()},showChartCSS:{},hideChartCSS:{opacity:0}},f.chartOptions={},f.cchartOptions={},f.timer=!1,f.tableClone=!1,f.chartId=f.optionsInit.chartId,f.googleSheetData=!1,f.dataArray=[],f.chartPackage="corechart",f.coreCharts=["BarChart","ColumnChart","PieChart","AreaChart","BubbleChart","CandlestickChart","ComboChart","Histogram","LineChart","ScatterChart","SteppedAreaChart"],f.chartParent=!1,f.windowWidth=!1,f.chartParentWidth=!1,f.init=function(b,c){var d=!1;f.options=a.extend({},f.optionsInit,c),f.chartId=c.chartId||h.attr("id")||f.options.chartId,f.options.tableSel&&(g=a(f.options.tableSel+" td").length?a(f.options.tableSel):g),d=g.find("td").length,d&&(f.tableClone=g.clone()),h[0]===g[0]&&(d?h=a('<div id="'+f.chartId+'" class="'+f.chartId+" "+f.options.chartClass+'"></div>').insertAfter(g):g=!1),h.addClass(f.chartId+" "+f.options.chartClass).attr("id",f.chartId),f.chartParent=h.parent(),f.options.googleSheetKey?f.getGoogleSheet(f.options.googleSheetKey,f.setupChart):f.setupChart()},f.getGoogleSheet=function(b,c){a.ajax({type:"GET",url:"https://spreadsheets.google.com/spreadsheet/pub?key="+b+"&output=csv",dataType:"text"}).done(function(a){f.googleSheetData=a,c()}).fail(function(a){f.googleSheetData=a,c(),console.log("Google Sheet failed")})},f.setupChart=function(){if(f.dataArray=f.collectData(),!f.dataArray.length)return f.showTableChart("show","remove"),void console.log("No data found in data array");-1===f.coreCharts.indexOf(f.options.chartType)&&(f.chartPackage=f.options.chartType.toLowerCase()),f.options.chartOptions?f.chartOptions=f.options.chartOptions:f.options[f.camelCase(f.options.chartType)]&&(f.chartOptions=f.options[f.camelCase(f.options.chartType)]),f.cchartOptions=a.extend(!0,{},f.chartOptions),"Calendar"===f.options.chartType&&(f.cchartOptions.calendar.cellSize=f.cchartOptions.calendar.cellSize||h.width()*f.cchartOptions.cellScaleFactor),f.showTableChart("hide","hide");try{a.ajax({url:f.options.urlJSAPI,dataType:"script",cache:!0}).done(function(){google.load("visualization","1",{packages:[f.chartPackage],callback:f.drawChart}),f.addResize()}).fail(function(){f.showTableChart("show","remove")})}catch(b){f.showTableChart("show","remove"),console.log(b)}},f.collectData=function(){var b=[];if(f.googleSheetData&&!f.googleSheetData.statusText?b=f.formatSheet(f.googleSheetData):f.googleSheetData&&console.log(f.googleSheetData),f.tableClone&&f.tableClone.find("td").length&&(b=f.getTableData(),f.cchartOptions.title=f.cchartOptions.title||f.tableClone.find("caption").text()||""),f.options.columns)if(b[0]&&b[0][0]&&b[0][0].label)if(f.options.colIndexes)for(var c=0;c<f.options.colIndexes.length;c++)b[0].splice(f.options.colIndexes[c],0,f.options.columns[c]);else b[0]=f.options.columns;else b.unshift(f.options.columns);if(f.options.rows&&b.length)if(f.options.colIndexes)for(var c=0;c<f.options.rows.length;c++)for(var d=0;d<f.options.colIndexes.length;d++)b[c+1].splice(f.options.colIndexes[d],0,f.options.rows[c][d]);else a.merge(b,f.options.rows);return b},f.drawChart=function(){if(f.data=new google.visualization.arrayToDataTable(f.dataArray),!f.data||!f.data.getNumberOfRows())return f.showTableChart("show","remove"),void console.log("Google Charts data table failed");if(f.cchartOptions.formatter&&"none"!==f.cchartOptions.formatter.type){var c=new google.visualization[f.cchartOptions.formatter.type](f.cchartOptions.formatter);c.format(f.data,f.cchartOptions.formatter.column)}if(f.cchartOptions.fontSize&&isNaN(parseInt(f.cchartOptions.fontSize,10))&&(f.cchartOptions.fontSize=f.getFontSize(f.cchartOptions.fontSize,16)),f.cchartOptions.titleTextStyle&&f.cchartOptions.titleTextStyle.fontSize&&isNaN(parseInt(f.cchartOptions.titleTextStyle.fontSize,10))&&(f.cchartOptions.titleTextStyle.fontSize=f.getFontSize(f.cchartOptions.titleTextStyle.fontSize,16)),f.cchartOptions.calendar&&(f.cchartOptions.calendar.monthLabel&&f.cchartOptions.calendar.monthLabel.fontSize&&isNaN(parseInt(f.cchartOptions.calendar.monthLabel.fontSize,10))&&(f.cchartOptions.calendar.monthLabel.fontSize=f.getFontSize(f.cchartOptions.calendar.monthLabel.fontSize,16)),f.cchartOptions.calendar.dayOfWeekLabel&&f.cchartOptions.calendar.dayOfWeekLabel.fontSize&&isNaN(parseInt(f.cchartOptions.calendar.dayOfWeekLabel.fontSize,10))&&(f.cchartOptions.calendar.dayOfWeekLabel.fontSize=f.getFontSize(f.cchartOptions.calendar.dayOfWeekLabel.fontSize,16))),f.setDimensions(),"BarChart"===f.options.chartType&&!f.options.chartAspectRatio&&!f.chartOptions.height){var d=f.cchartOptions.fontSize||f.getFontSize("body",16);f.cchartOptions.height=2*d*f.data.getNumberOfRows()}f.chart=new google.visualization[f.options.chartType](h.get(0)),google.visualization.events.addListener(f.chart,"ready",function(){if(f.showTableChart(f.options.showTable,"show"),f.windowWidth=a(b).width(),f.chartParentWidth=f.chartParent.width(),f.options.chartZoom||f.options.chartOffset){var c="",d=h.children(":last"),e=0,g=0,i=parseFloat(f.options.chartZoom)||0,j=1/i||1,k=parseInt(f.options.chartOffset[0])||0,l=parseInt(f.options.chartOffset[1])||0;k=k*h.width()*i/100,l=l*h.height()*i/100,i&&(c="scale("+i+")",e=(h.height()*i-h.height())/2/i,g=(h.width()*i-h.width())/2/i),(k||l)&&(c+=" translate("+k+"px,"+l+"px)",e-=l,g-=k),d.css("transform",c),h.css("overflow","hidden"),a("<style> ."+f.chartId+" .google-visualization-tooltip{ top: "+e+"px !important; left: "+g+"px !important; transform: scale("+j+")} </style>").appendTo("head")}}),google.visualization.events.addListener(f.chart,"error",function(a){f.showTableChart("show","remove"),console.log(a)}),f.chart.draw(f.data,f.cchartOptions)},f.formatSheet=function(a){var b=[];if(a&&!a.statusText)try{for(var c=a.split(/\r\n|\n/),d=[],e=0;e<c.length;e++){var g=c[e].split(",");c[e]=g}f.options.transpose&&(c=f.transpose(c)),d=c[0];for(var e=0;e<d.length;e++)d[e]="TOOLTIP"===d[e].toUpperCase()?{type:"string",role:"tooltip"}:"ANNOTATION"===d[e].toUpperCase()?{type:"string",role:"annotation"}:{label:d[e]};b=c,b[0]=d,b=f.formatData(b)}catch(h){console.log(h)}return b},f.getTableData=function(){var b=[];try{var c=f.tableClone.find("tr"),d=[];c.each(function(b){d.push([]),a(this).find("td, th").each(function(){var c=a(this),e={};c.attr("data-type")&&(e.type=c.attr("data-type")),c.attr("data-role")&&(e.role=c.attr("data-role")),e.label=c.text(),d[b].push(e)})}),f.options.transpose&&(d=f.transpose(d)),b.push(d[0]);for(var e=1;e<d.length;e++){for(var g=[],h=0;h<d[e].length;h++){var i=d[e][h].label||"";g.push(i)}g.length>0&&b.push(g)}b=f.formatData(b)}catch(j){return console.log(j),[]}return b},f.formatData=function(b){var c=b;try{var d=[],e=[],g=[],h=function(a,b){return-1===f.options.ignoreRow.indexOf(b)},i=function(a,b){return-1===f.options.ignoreCol.indexOf(b)},j=function(a,b){return-1===d.indexOf(b)};f.options.tooltipConcat&&e.push("tooltip"),f.options.annotationConcat&&e.push("annotation"),c=a.grep(c,h);for(var k=0;k<c.length;k++)c[k]=a.grep(c[k],i);if(e.length){for(var l="",m=0;m<c[0].length;m++){var n=c[0][m].role||"";n&&-1!==e.indexOf(n)&&d.push(m)}for(var k=0;k<c.length;k++)c[k]=a.grep(c[k],j);for(var m=0;m<c[0].length;m++){var n=c[0][m].role||"",o=c[0][m].label||"";if(("domain"===n||0===m)&&(l=c[0][m]),(!n||-1===e.indexOf(n))&&m>0)for(var k=0;k<e.length;k++)m++,c[0].splice(m,0,{type:"string",role:e[k]}),g.push({index:m,domain:l,role:e[k],label:o})}for(var m=1;m<c.length;m++)for(var k=0;k<g.length;k++){var p="";"toolip"===g[k].role?p=f.options.tooltipConcat:"annotation"===g[k].role&&(p=f.options.annotationConcat),p=p.replace(new RegExp("domain","g"),g[k].domain),p=p.replace(new RegExp("label","g"),g[k].label),p=p.replace(new RegExp("data","g"),c[m][g[k].index]),c[m].splice(g[k].index,0,p)}}for(var m=1;m<c.length;m++){for(var q=[],k=0;k<c[m].length;k++){var r=c[0][k].type||"",s=c[0][k].role||"",t=c[m][k]||"";if(-1===["tooltip","annotation"].indexOf(s))if("date"===r||"datetime"===r)t=new Date(t);else if("number"===r)t=parseFloat(t);else if("boolean"===r){var u=t.toLowerCase();t="false"!==u&&"0"!==u&&"no"!==u&&""!==u}else"timeofday"===r?t=t.getTime():0!==k&&(isNaN(parseFloat(t))?"Invalid Date"===new Date(t)||isNaN(new Date(t))||(t=new Date(t)):t=parseFloat(t));q.push(t)}q.length>0&&(c[m]=q)}}catch(v){return console.log(v),[]}return c},f.addResize=function(){a(b).on({resize:function(){clearTimeout(f.timer),f.timer=setTimeout(function(){if(a(b).width()!==f.windowWidth){var c=h.attr("style");h.removeAttr("style"),f.chartParent.width()!==f.chartParentWidth?(f.cchartOptions.calendar&&!f.options.calendar.calendar.cellSize&&(f.cchartOptions.calendar.cellSize=.017*h.width()),f.setDimensions(),f.chart.draw(f.data,f.cchartOptions)):h.attr("style",c)}},500)}})},f.showTableChart=function(a,b){var c=g?g.length:!1,d=h?h.length:!1;"show"===a&&c?(g.css("opacity",0),g.css(f.options.showTableCSS),g.fadeTo(400,1)):"hide"===a&&c?g.css(f.options.hideTableCSS):"remove"===a&&c&&g.css("display","none"),"show"===b&&d?(h.css("opacity",0),h.css(f.options.showChartCSS),h.fadeTo(400,1)):"hide"===b&&d?h.css(f.options.showChartCSS):"remove"===b&&d&&h.css("display","none")},f.getFontSize=function(b,c){return parseInt(a(b).css("fontSize"),10)||c},f.transpose=function(a){for(var b=new Array(a[0].length),c=0;c<a[0].length;c++){b[c]=new Array(a.length);for(var d=0;d<a.length;d++)b[c][d]=a[d][c]}return b},f.setDimensions=function(){f.chartParentWidth=f.chartParent.width(),f.options.chartAspectRatio?f.chartOptions.width&&!f.chartOptions.height?f.cchartOptions.height=f.chartOptions.width/f.options.chartAspectRatio:!f.chartOptions.width&&f.chartOptions.height?f.cchartOptions.width=f.chartOptions.height*f.options.chartAspectRatio:f.chartOptions.width||f.chartOptions.height||(f.cchartOptions.width=f.chartParentWidth,f.cchartOptions.height=f.cchartOptions.width/f.options.chartAspectRatio):f.chartOptions.width||f.chartOptions.height||(f.cchartOptions.width=f.chartParentWidth)},f.camelCase=function(a){return a.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(a,b){return 0===+a?"":0===b?a.toLowerCase():a.toUpperCase()})},f.init(c,e),this};a.fn.chartinator=function(b){return this.each(function(){var c=a(this);c.data("chartinator")||a(this).data("chartinator",new e(this,b))})}}(jQuery,window,document,Math);